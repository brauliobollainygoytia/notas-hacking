# Mini RSA
What happens if you have a small exponent? There is a twist though, we padded the plaintext so that (M ** e) is just barely larger than N. Let's decrypt this: [ciphertext](https://mercury.picoctf.net/static/a24cf907007a19dbf30310acad0df9e5/ciphertext)
RSA [tutorial](https://en.wikipedia.org/wiki/RSA_\(cryptosystem\))
How could having too small of an `e` affect the security of this key?
Make sure you don't lose precision, the numbers are pretty big (besides the `e` value)
You shouldn't have to make _too_ many guesses
`pico` is in the flag, but not at the beginning

## Solución
Con la terminal de Kali linux y ptyhon
```
┌──(kali㉿kali)-[~/Documents/srss/crypto]
└─$ wget https://mercury.picoctf.net/static/a24cf907007a19dbf30310acad0df9e5/ciphertext
--2025-05-22 17:52:30--  https://mercury.picoctf.net/static/a24cf907007a19dbf30310acad0df9e5/ciphertext
Resolving mercury.picoctf.net (mercury.picoctf.net)... 18.189.209.142
Connecting to mercury.picoctf.net (mercury.picoctf.net)|18.189.209.142|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 2039 (2.0K) [application/octet-stream]
Saving to: ‘ciphertext’

ciphertext                                100%[====================================================================================>]   1.99K  --.-KB/s    in 0s      

2025-05-22 17:52:31 (76.8 MB/s) - ‘ciphertext’ saved [2039/2039]

                                                                                                                                                                       
┌──(kali㉿kali)-[~/Documents/srss/crypto]
└─$ cat ciphertext 
N: 1615765684321463054078226051959887884233678317734892901740763321135213636796075462401950274602405095138589898087428337758445013281488966866073355710771864671726991918706558071231266976427184673800225254531695928541272546385146495736420261815693810544589811104967829354461491178200126099661909654163542661541699404839644035177445092988952614918424317082380174383819025585076206641993479326576180793544321194357018916215113009742654408597083724508169216182008449693917227497813165444372201517541788989925461711067825681947947471001390843774746442699739386923285801022685451221261010798837646928092277556198145662924691803032880040492762442561497760689933601781401617086600593482127465655390841361154025890679757514060456103104199255917164678161972735858939464790960448345988941481499050248673128656508055285037090026439683847266536283160142071643015434813473463469733112182328678706702116054036618277506997666534567846763938692335069955755244438415377933440029498378955355877502743215305768814857864433151287
e: 3

ciphertext (c): 1220012318588871886132524757898884422174534558055593713309088304910273991073554732659977133980685370899257850121970812405700793710546674062154237544840177616746805668666317481140872605653768484867292138139949076102907399831998827567645230986345455915692863094364797526497302082734955903755050638155202890599808145893251774383242888588567652079502880522005531571120463301333725071534050137246298274874319432561063978068140428652193294702808687000503934999928337234367205234422580586283326017530708854836817980318398277272759022724136418545105867685463283579824831916699431331460258806680372323026200534791012439563034432826050072742892112790177234284090476467119938191076883854821999876464545771711445501514467804193760659882386680300508589975451301720477703627085437101600726487172968870448635983769708507451946168500510817590720157574816563284526466526806699820426206566718022595284382939272542309819250701217431454132436646725890151031992160610219312035760562959174778547776304922277751548955049884940378

python3 exp.py   
Encontre raiz cuadrada con k=3533
Texto plano como numero:  1787330808968142828287809319332701517353332911736848279839502759158602467824780424488141955644417387373185756944952906538004355347478978500948630620749868180414755933760446136287315896825929319145984883756667607031853695069891380871892213007874933611243319812691520078269033745367443951846845107464675742664639073699800384973262142189949
Texto desencriptado como ascii b'                                                                                                        picoCTF{e_sh0u1d_b3_lArg3r_0b39bbb1}'
from gmpy2 import *

n = 161576568432146305407822605195988788423367831773489290174076332113521363679607546240195027460240509513858989808742833775844501328148896686607335571077186467172699>
e = 3
c = 122001231858887188613252475789888442217453455805559371330908830491027399107355473265997713398068537089925785012197081240570079371054667406215423754484017761674680>

for k in range(1, 1000000):
        candidate = c + k * n
        m_root, exact = iroot(candidate, e)
        if exact:
                print(f"Encontre raiz cuadrada con k={k}")
                print("Texto plano como numero: ", m_root)
                print("Texto desencriptado como ascii", bytes.fromhex(hex(m_root)[2:]))
                break

```
